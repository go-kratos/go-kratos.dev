"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7607],{8453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>a});var r=o(6540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},9431:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"getting-started/usage","title":"CLI\u5de5\u5177","description":"Kratos \u5de5\u5177\u4f7f\u7528\uff0c\u521b\u5efa Protobuf \u6a21\u677f\uff0c\u521b\u5efa Go \u5de5\u7a0b\u9879\u76ee\uff0c\u521b\u5efa Service \u6a21\u677f","source":"@site/docs/getting-started/02-usage.md","sourceDirName":"getting-started","slug":"/getting-started/usage","permalink":"/docs/getting-started/usage","draft":false,"unlisted":false,"editUrl":"https://github.com/go-kratos/go-kratos.dev/edit/main/docs/getting-started/02-usage.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"usage","title":"CLI\u5de5\u5177","description":"Kratos \u5de5\u5177\u4f7f\u7528\uff0c\u521b\u5efa Protobuf \u6a21\u677f\uff0c\u521b\u5efa Go \u5de5\u7a0b\u9879\u76ee\uff0c\u521b\u5efa Service \u6a21\u677f","keywords":["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},"sidebar":"docs","previous":{"title":"\u9879\u76ee\u521d\u59cb\u5316","permalink":"/docs/getting-started/start"},"next":{"title":"\u63d2\u4ef6","permalink":"/docs/getting-started/plugin"}}');var t=o(4848),s=o(8453);const l={id:"usage",title:"CLI\u5de5\u5177",description:"Kratos \u5de5\u5177\u4f7f\u7528\uff0c\u521b\u5efa Protobuf \u6a21\u677f\uff0c\u521b\u5efa Go \u5de5\u7a0b\u9879\u76ee\uff0c\u521b\u5efa Service \u6a21\u677f",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},a=void 0,i={},c=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u521b\u5efa\u9879\u76ee",id:"\u521b\u5efa\u9879\u76ee",level:3},{value:"\u6dfb\u52a0 Proto \u6587\u4ef6",id:"\u6dfb\u52a0-proto-\u6587\u4ef6",level:3},{value:"\u751f\u6210 Proto \u4ee3\u7801",id:"\u751f\u6210-proto-\u4ee3\u7801",level:3},{value:"\u751f\u6210 Service \u4ee3\u7801",id:"\u751f\u6210-service-\u4ee3\u7801",level:3},{value:"\u8fd0\u884c\u9879\u76ee",id:"\u8fd0\u884c\u9879\u76ee",level:3},{value:"\u67e5\u770b\u7248\u672c",id:"\u67e5\u770b\u7248\u672c",level:3},{value:"\u5de5\u5177\u5347\u7ea7",id:"\u5de5\u5177\u5347\u7ea7",level:3},{value:"\u66f4\u65b0\u65e5\u5fd7",id:"\u66f4\u65b0\u65e5\u5fd7",level:3},{value:"\u67e5\u770b\u5e2e\u52a9",id:"\u67e5\u770b\u5e2e\u52a9",level:3}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"go install github.com/go-kratos/kratos/cmd/kratos/v2@latest\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u521b\u5efa\u9879\u76ee",children:"\u521b\u5efa\u9879\u76ee"}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7 kratos \u547d\u4ee4\u521b\u5efa\u9879\u76ee\u6a21\u677f\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos new helloworld\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"-r"})," \u6307\u5b9a\u6e90"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u56fd\u5185\u62c9\u53d6\u5931\u8d25\u53ef\u4f7f\u7528gitee\u6e90\nkratos new helloworld -r https://gitee.com/go-kratos/kratos-layout.git\n# \u4ea6\u53ef\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6a21\u677f\nkratos new helloworld -r xxx-layout.git\n# \u540c\u65f6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u6e90\nKRATOS_LAYOUT_REPO=xxx-layout.git\nkratos new helloworld\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"-b"})," \u6307\u5b9a\u5206\u652f"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos new helloworld -b main\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"--nomod"})," \u6dfb\u52a0\u670d\u52a1\uff0c\u5171\u7528 ",(0,t.jsx)(n.code,{children:"go.mod"})," \uff0c\u5927\u4ed3\u6a21\u5f0f"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos new helloworld\ncd helloworld\nkratos new app/user --nomod\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8f93\u51fa:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:".\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 api\n\u2502\xa0\xa0 \u2514\u2500\u2500 helloworld\n\u2502\xa0\xa0     \u2514\u2500\u2500 v1\n\u2502\xa0\xa0         \u251c\u2500\u2500 error_reason.pb.go\n\u2502\xa0\xa0         \u251c\u2500\u2500 error_reason.proto\n\u2502\xa0\xa0         \u251c\u2500\u2500 greeter.pb.go\n\u2502\xa0\xa0         \u251c\u2500\u2500 greeter.proto\n\u2502\xa0\xa0         \u251c\u2500\u2500 greeter_grpc.pb.go\n\u2502\xa0\xa0         \u2514\u2500\u2500 greeter_http.pb.go\n\u251c\u2500\u2500 app\n\u2502\xa0\xa0 \u2514\u2500\u2500 user\n\u2502\xa0\xa0     \u251c\u2500\u2500 Dockerfile\n\u2502\xa0\xa0     \u251c\u2500\u2500 Makefile\n\u2502\xa0\xa0     \u251c\u2500\u2500 cmd\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 user\n\u2502\xa0\xa0     \u2502\xa0\xa0     \u251c\u2500\u2500 main.go\n\u2502\xa0\xa0     \u2502\xa0\xa0     \u251c\u2500\u2500 wire.go\n\u2502\xa0\xa0     \u2502\xa0\xa0     \u2514\u2500\u2500 wire_gen.go\n\u2502\xa0\xa0     \u251c\u2500\u2500 configs\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 config.yaml\n\u2502\xa0\xa0     \u251c\u2500\u2500 internal\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 biz\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 biz.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 greeter.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 conf\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 conf.pb.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 conf.proto\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 data\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 data.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 greeter.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u251c\u2500\u2500 server\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 grpc.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 http.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 server.go\n\u2502\xa0\xa0     \u2502\xa0\xa0 \u2514\u2500\u2500 service\n\u2502\xa0\xa0     \u2502\xa0\xa0     \u251c\u2500\u2500 greeter.go\n\u2502\xa0\xa0     \u2502\xa0\xa0     \u2514\u2500\u2500 service.go\n\u2502\xa0\xa0     \u2514\u2500\u2500 openapi.yaml\n\u251c\u2500\u2500 cmd\n\u2502\xa0\xa0 \u2514\u2500\u2500 helloworld\n\u2502\xa0\xa0     \u251c\u2500\u2500 main.go\n\u2502\xa0\xa0     \u251c\u2500\u2500 wire.go\n\u2502\xa0\xa0     \u2514\u2500\u2500 wire_gen.go\n\u251c\u2500\u2500 configs\n\u2502\xa0\xa0 \u2514\u2500\u2500 config.yaml\n\u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 go.sum\n\u251c\u2500\u2500 internal\n\u2502\xa0\xa0 \u251c\u2500\u2500 biz\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 README.md\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 biz.go\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 greeter.go\n\u2502\xa0\xa0 \u251c\u2500\u2500 conf\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 conf.pb.go\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 conf.proto\n\u2502\xa0\xa0 \u251c\u2500\u2500 data\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 README.md\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 data.go\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 greeter.go\n\u2502\xa0\xa0 \u251c\u2500\u2500 server\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 grpc.go\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 http.go\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 server.go\n\u2502\xa0\xa0 \u2514\u2500\u2500 service\n\u2502\xa0\xa0     \u251c\u2500\u2500 README.md\n\u2502\xa0\xa0     \u251c\u2500\u2500 greeter.go\n\u2502\xa0\xa0     \u2514\u2500\u2500 service.go\n\u251c\u2500\u2500 openapi.yaml\n\u2514\u2500\u2500 third_party\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 errors\n    \u2502\xa0\xa0 \u2514\u2500\u2500 errors.proto\n    \u251c\u2500\u2500 google\n    \u2502\xa0\xa0 \u251c\u2500\u2500 api\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 annotations.proto\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 client.proto\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 field_behavior.proto\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 http.proto\n    \u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 httpbody.proto\n    \u2502\xa0\xa0 \u2514\u2500\u2500 protobuf\n    \u2502\xa0\xa0     \u2514\u2500\u2500 descriptor.proto\n    \u2514\u2500\u2500 validate\n        \u251c\u2500\u2500 README.md\n        \u2514\u2500\u2500 validate.proto\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u6dfb\u52a0-proto-\u6587\u4ef6",children:"\u6dfb\u52a0 Proto \u6587\u4ef6"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"kratos-layout \u9879\u76ee\u4e2d\u5bf9 proto \u6587\u4ef6\u8fdb\u884c\u4e86\u7248\u672c\u5212\u5206\uff0c\u653e\u5728\u4e86 v1 \u5b50\u76ee\u5f55\u4e0b"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos proto add api/helloworld/v1/demo.proto\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8f93\u51fa:"}),"\n",(0,t.jsx)(n.p,{children:"api/helloworld/v1/demo.proto"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:'syntax = "proto3";\n\npackage api.helloworld.v1;\n\noption go_package = "helloworld/api/helloworld/v1;v1";\noption java_multiple_files = true;\noption java_package = "api.helloworld.v1";\n\nservice Demo {\n\trpc CreateDemo (CreateDemoRequest) returns (CreateDemoReply);\n\trpc UpdateDemo (UpdateDemoRequest) returns (UpdateDemoReply);\n\trpc DeleteDemo (DeleteDemoRequest) returns (DeleteDemoReply);\n\trpc GetDemo (GetDemoRequest) returns (GetDemoReply);\n\trpc ListDemo (ListDemoRequest) returns (ListDemoReply);\n}\n\nmessage CreateDemoRequest {}\nmessage CreateDemoReply {}\n\nmessage UpdateDemoRequest {}\nmessage UpdateDemoReply {}\n\nmessage DeleteDemoRequest {}\nmessage DeleteDemoReply {}\n\nmessage GetDemoRequest {}\nmessage GetDemoReply {}\n\nmessage ListDemoRequest {}\nmessage ListDemoReply {}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u6210-proto-\u4ee3\u7801",children:"\u751f\u6210 Proto \u4ee3\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 make \u547d\u4ee4\u751f\u6210\nmake api\n\n# \u6216\u4f7f\u7528 kratos cli \u8fdb\u884c\u751f\u6210\nkratos proto client api/helloworld/v1/demo.proto\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4f1a\u5728 proto \u6587\u4ef6\u540c\u76ee\u5f55\u4e0b\u751f\u6210:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"api/helloworld/v1/demo.pb.go\napi/helloworld/v1/demo_grpc.pb.go\n# \u6ce8\u610f http \u4ee3\u7801\u53ea\u4f1a\u5728 proto \u6587\u4ef6\u4e2d\u58f0\u660e\u4e86 http \u65f6\u624d\u4f1a\u751f\u6210\napi/helloworld/v1/demo_http.pb.go\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u6210-service-\u4ee3\u7801",children:"\u751f\u6210 Service \u4ee3\u7801"}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7 proto \u6587\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u751f\u6210\u5bf9\u5e94\u7684 Service \u5b9e\u73b0\u4ee3\u7801\uff1a"}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"-t"})," \u6307\u5b9a\u751f\u6210\u76ee\u5f55"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos proto server api/helloworld/v1/demo.proto -t internal/service\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u8f93\u51fa:",(0,t.jsx)(n.br,{}),"\n","internal/service/demo.go"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:'package service\n\nimport (\n\t"context"\n\n\tpb "helloworld/api/helloworld"\n)\n\ntype DemoService struct {\n\tpb.UnimplementedDemoServer\n}\n\nfunc NewDemoService() *DemoService {\n\treturn &DemoService{}\n}\n\nfunc (s *DemoService) CreateDemo(ctx context.Context, req *pb.CreateDemoRequest) (*pb.CreateDemoReply, error) {\n\treturn &pb.CreateDemoReply{}, nil\n}\nfunc (s *DemoService) UpdateDemo(ctx context.Context, req *pb.UpdateDemoRequest) (*pb.UpdateDemoReply, error) {\n\treturn &pb.UpdateDemoReply{}, nil\n}\nfunc (s *DemoService) DeleteDemo(ctx context.Context, req *pb.DeleteDemoRequest) (*pb.DeleteDemoReply, error) {\n\treturn &pb.DeleteDemoReply{}, nil\n}\nfunc (s *DemoService) GetDemo(ctx context.Context, req *pb.GetDemoRequest) (*pb.GetDemoReply, error) {\n\treturn &pb.GetDemoReply{}, nil\n}\nfunc (s *DemoService) ListDemo(ctx context.Context, req *pb.ListDemoRequest) (*pb.ListDemoReply, error) {\n\treturn &pb.ListDemoReply{}, nil\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u8fd0\u884c\u9879\u76ee",children:"\u8fd0\u884c\u9879\u76ee"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u5982\u5b50\u76ee\u5f55\u4e0b\u6709\u591a\u4e2a\u9879\u76ee\u5219\u51fa\u73b0\u9009\u62e9\u83dc\u5355"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos run\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u67e5\u770b\u7248\u672c",children:"\u67e5\u770b\u7248\u672c"}),"\n",(0,t.jsx)(n.p,{children:"\u67e5\u770b\u5de5\u5177\u7248\u672c\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos -v\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8f93\u51fa:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos version v2.2.0\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u5de5\u5177\u5347\u7ea7",children:"\u5de5\u5177\u5347\u7ea7"}),"\n",(0,t.jsx)(n.p,{children:"\u5c06\u5347\u7ea7\u4ee5\u4e0b\u5de5\u5177"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Kratos \u4e0e\u5de5\u5177\u81ea\u8eab"}),"\n",(0,t.jsx)(n.li,{children:"protoc \u76f8\u5173\u7684\u751f\u6210\u63d2\u4ef6"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos upgrade\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u66f4\u65b0\u65e5\u5fd7",children:"\u66f4\u65b0\u65e5\u5fd7"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u7b49\u540c\u4e8e\u6253\u5370 https://github.com/go-kratos/kratos/releases/latest \u7684\u7248\u672c\u66f4\u65b0\u65e5\u5fd7\nkratos changelog\n\n# \u6253\u5370\u6307\u5b9a\u7248\u672c\u66f4\u65b0\u65e5\u5fd7\nkratos changelog v2.1.4\n\n# \u67e5\u770b\u4ece latest \u7248\u672c\u53d1\u5e03\u540e\u81f3\u4eca\u7684\u66f4\u65b0\u65e5\u5fd7\nkratos changelog dev\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u67e5\u770b\u5e2e\u52a9",children:"\u67e5\u770b\u5e2e\u52a9"}),"\n",(0,t.jsxs)(n.p,{children:["\u4efb\u4f55\u547d\u4ee4\u4e0b\u52a0 ",(0,t.jsx)(n.code,{children:"-h"})," \u67e5\u770b\u5e2e\u52a9"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kratos -h\nkratos new -h\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);